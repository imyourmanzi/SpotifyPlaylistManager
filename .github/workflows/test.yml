name: Deploy Application

on: pull_request

jobs:
  # This job is based on one that was auto-generated by the Firebase CLI
  # https://github.com/firebase/firebase-tools
  ui:
    name: UI
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: 'npm'
      - id: package
        run: echo "contents=$(cat package.json | tr -d '\n')" >> "$GITHUB_OUTPUT"
      - run: npx -y nx@{{ fromJSON(steps.package.outputs.contents)['devDependencies']['@nrwl/cli'] }} build:docker server
      - run: docker tag docker tag spm-server:latest us-central1-docker.pkg.dev/imyourmanzi-spotifyplaylistmgr/server-images/server:latest
